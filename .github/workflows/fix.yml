name: üõ†Ô∏è One-Time Post Fixer

on:
  workflow_dispatch:

jobs:
  fix-posts:
    permissions:
      contents: write
      
    runs-on: ubuntu-latest
    steps:
      - name: ‚¨áÔ∏è Checkout repo
        uses: actions/checkout@v4
        with:
          # –í–∞–∂–Ω–æ, —á—Ç–æ–±—ã –±–æ—Ç –º–æ–≥ –¥–µ–ª–∞—Ç—å push
          token: ${{ secrets.GITHUB_TOKEN }}

      - name: ‚öôÔ∏è Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: üì¶ Install dependencies
        run: npm install

      - name: üîß Run the Fixer Script
        run: npm run fix

      - name: üöÄ Commit and Push Fixes
        run: |
          git config --global user.name 'GitHub Actions Bot'
          git config --global user.email 'actions-bot@github.com'
          
          if [[ -z $(git status --porcelain) ]]; then
            echo "‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –í—Å–µ —Ñ–∞–π–ª—ã —É–∂–µ –±—ã–ª–∏ –≤ –ø–æ—Ä—è–¥–∫–µ."
            exit 0
          fi

          echo "üî• –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –±—Ä–∞–∫–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã. –ü—É–±–ª–∏–∫—É—é –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è..."
          # –î–æ–±–∞–≤–ª—è–µ–º –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ –≤ –ø–∞–ø–∫–µ posts
          git add .
          git commit -m "üõ†Ô∏è –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–º–æ–Ω—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Å—Ç–∞—Ç–µ–π"
          # –î–æ–±–∞–≤–ª—è–µ–º pull, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
          git pull --rebase
          git push
