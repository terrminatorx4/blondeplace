name: üß† Smart Fix (–ò—Å–ø—Ä–∞–≤–ª—è–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã, –ù–ï —É–¥–∞–ª—è–µ—Ç)

on:
  workflow_dispatch:

jobs:
  smart-fix:
    permissions:
      contents: write
      
    runs-on: ubuntu-latest
    steps:
      - name: ‚¨áÔ∏è Checkout repo
        uses: actions/checkout@v4
        with:
          fetch-depth: 0  # –ù—É–∂–Ω–∞ –ø–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
          token: ${{ secrets.GITHUB_TOKEN }}

      - name: ‚öôÔ∏è Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: üì¶ Install dependencies
        run: npm install

      - name: üß† Smart Fix Git Conflicts
        run: node restore-and-fix.js

      - name: üöÄ Commit Fixed Files
        run: |
          git config --global user.name 'GitHub Actions Bot'
          git config --global user.email 'actions-bot@github.com'
          
          if [[ -z $(git status --porcelain) ]]; then
            echo "‚úÖ –í—Å–µ —Ñ–∞–π–ª—ã —É–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∏–ª–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ."
            exit 0
          fi

          echo "üîß –ù–∞–π–¥–µ–Ω—ã –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã —Ñ–∞–π–ª—ã —Å Git –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞–º–∏. –ü—É–±–ª–∏–∫—É—é..."
          git add .
          git commit -m "üß† –£–º–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Git –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ (–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ + —Ñ–∏–∫—Å)"
          git pull --rebase
          git push 